# This file contains common pin mappings for the BigTreeTech Octopus V1.
# To use this config, the firmware should be compiled for the STM32F446 with a "32KiB bootloader"
# Enable "extra low-level configuration options" and select the "12MHz crystal" as clock reference

# after running "make", copy the generated "klipper/out/klipper.bin" file to a
# file named "firmware.bin" on an SD card and then restart the OctoPus with that SD card.

# See docs/Config_Reference.md for a description of parameters.

## Voron Design VORON2 250/300/350mm BigTreeTech OctoPus V1 TMC2209 UART config

## *** THINGS TO CHANGE/CHECK: ***
## MCU paths                            [mcu] section
## Thermistor types                     [extruder] and [heater_bed] sections - See https://www.klipper3d.org/Config_Reference.html#common-thermistors for common thermistor types
## Z Endstop Switch location            [safe_z_home] section
## Homing end position                  [gcode_macro G32] section
## Z Endstop Switch  offset for Z0      [stepper_z] section
## Probe points                         [quad_gantry_level] section
## Min & Max gantry corner postions     [quad_gantry_level] section
## PID tune                             [extruder] and [heater_bed] sections
## Probe pin                            [probe] section
## Fine tune E steps                    [extruder] section

[include mainsail.cfg]

[force_move]
enable_force_move: True

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_10000F000D50315939343520-if00
restart_method: command

[mcu can0]
canbus_uuid: e8e65c910c08

#[mcu nhk]
#serial: /dev/serial/by-id/usb-Klipper_rp2040_3033393834091DAB-if00
#restart_method: command

[include macros/*.cfg]
[include configs/*.cfg]
[include KAMP/KAMP_Settings.cfg]

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 3000             #Max 4000
max_z_velocity: 15          #Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

[temperature_sensor chamber_temp]
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: PF5
min_temp: 0
max_temp: 100
gcode_id: chamber_th

[temperature_sensor ToolHead]
sensor_type: temperature_mcu
sensor_mcu: can0
min_temp: 0
max_temp: 100

[adxl345]
cs_pin: can0:PB12
spi_software_sclk_pin: can0:PB10
spi_software_mosi_pin: can0:PB11
spi_software_miso_pin: can0:PB2
axes_map: x,y,z

[resonance_tester]
accel_chip: adxl345
probe_points:
    100,150,20  # an example for a 300mm printer
#    150,150,20  # an example for a 300mm printer

[input_shaper]
#shaper_freq_x: 63.2
#shaper_type_x: mzv
#shaper_freq_y: 41.4
#shaper_type_y: mzv

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [beacon model default]
#*# model_coef = 1.5321520529714867,
#*# 	  1.8563781156823427,
#*# 	  0.7261782987353694,
#*# 	  0.25094728293005597,
#*# 	  0.37334869834129725,
#*# 	  0.5444820157157371,
#*# 	  -0.26926110657461544,
#*# 	  -0.5274896531997126,
#*# 	  0.23792861953972674,
#*# 	  0.2778839319068196
#*# model_domain = 3.210834725659852e-07,3.326612112466237e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 65.249820
#*# model_offset = 0.00000
#*#
#*# [heater_bed]
#*# pid_version = 1
#*# pid_target = 100.00
#*# pid_tolerance = 0.0200
#*# control = pid
#*# pid_kp = 47.108
#*# pid_ki = 1.611
#*# pid_kd = 344.474
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 14.145
#*# pid_ki = 0.650
#*# pid_kd = 77.002
#*# pid_version = 1
#*# pid_target = 245.00
#*# pid_tolerance = 0.0200
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.110031, 0.115828, 0.114976, 0.116881, 0.116817, 0.116917, 0.117070, 0.116617, 0.119879, 0.123478, 0.124343, 0.122496, 0.119618, 0.115804, 0.114777, 0.116357, 0.114192, 0.109521, 0.105082, 0.102799, 0.099024, 0.096543, 0.086235, 0.075615, 0.064673
#*# 	0.096483, 0.103038, 0.104657, 0.107694, 0.107191, 0.108312, 0.109912, 0.108988, 0.111051, 0.116861, 0.121712, 0.120499, 0.116984, 0.111914, 0.111923, 0.114392, 0.111121, 0.104779, 0.101709, 0.099515, 0.095647, 0.090847, 0.081434, 0.070274, 0.059012
#*# 	0.086288, 0.094285, 0.096501, 0.100661, 0.098287, 0.098531, 0.100408, 0.101755, 0.100926, 0.106135, 0.111654, 0.113627, 0.111914, 0.105943, 0.106830, 0.108047, 0.106456, 0.100977, 0.099139, 0.095680, 0.091726, 0.086881, 0.075875, 0.064556, 0.055469
#*# 	0.082299, 0.088273, 0.089848, 0.092146, 0.092916, 0.092379, 0.091746, 0.089277, 0.092108, 0.098136, 0.102237, 0.104576, 0.104938, 0.101465, 0.100909, 0.098800, 0.095361, 0.093497, 0.092174, 0.085393, 0.080067, 0.078519, 0.069416, 0.058122, 0.053810
#*# 	0.080347, 0.084153, 0.087290, 0.086496, 0.086982, 0.086531, 0.084189, 0.082351, 0.083201, 0.093650, 0.098604, 0.100775, 0.098694, 0.097722, 0.095629, 0.091779, 0.089596, 0.088359, 0.085799, 0.076032, 0.070178, 0.065802, 0.061213, 0.051388, 0.043201
#*# 	0.070212, 0.075350, 0.076663, 0.077484, 0.075485, 0.070396, 0.070431, 0.070387, 0.074233, 0.081038, 0.084337, 0.089500, 0.090161, 0.083831, 0.080670, 0.081519, 0.081527, 0.077772, 0.070776, 0.065508, 0.060393, 0.050906, 0.040761, 0.036387, 0.027680
#*# 	0.054792, 0.059208, 0.061145, 0.061854, 0.058479, 0.055203, 0.055316, 0.058987, 0.058809, 0.060951, 0.063734, 0.070794, 0.073052, 0.070040, 0.064649, 0.066444, 0.066494, 0.057378, 0.051635, 0.044670, 0.039105, 0.028553, 0.020594, 0.017695, 0.009707
#*# 	0.028263, 0.031714, 0.034733, 0.036747, 0.038380, 0.039343, 0.039931, 0.041703, 0.044597, 0.047923, 0.050804, 0.050284, 0.050886, 0.052740, 0.050996, 0.050761, 0.045250, 0.038570, 0.031956, 0.022724, 0.015766, 0.013687, 0.008433, 0.003510, -0.004153
#*# 	0.012020, 0.012272, 0.015292, 0.018115, 0.024876, 0.026330, 0.026845, 0.028209, 0.033671, 0.040339, 0.039814, 0.035446, 0.036927, 0.040459, 0.038673, 0.035939, 0.031483, 0.023803, 0.017382, 0.005094, -0.000883, -0.000874, -0.003823, -0.011417, -0.019876
#*# 	0.005534, 0.008476, 0.008801, 0.010856, 0.013732, 0.014452, 0.017171, 0.021735, 0.025996, 0.030289, 0.031114, 0.030630, 0.029302, 0.025528, 0.021989, 0.023005, 0.019653, 0.012466, 0.006372, -0.000425, -0.006709, -0.008397, -0.016774, -0.019967, -0.028635
#*# 	0.003829, 0.005956, 0.007686, 0.010333, 0.009294, 0.011557, 0.016683, 0.018201, 0.019367, 0.021603, 0.024059, 0.024033, 0.020720, 0.016174, 0.014590, 0.016476, 0.013483, 0.008127, 0.002638, -0.005116, -0.012321, -0.019559, -0.023482, -0.026082, -0.032605
#*# 	-0.000930, 0.001882, 0.003370, 0.005899, 0.009794, 0.012211, 0.015064, 0.014855, 0.016142, 0.018443, 0.019944, 0.018271, 0.015557, 0.012658, 0.010251, 0.009826, 0.007862, 0.004469, -0.000815, -0.008018, -0.017146, -0.025085, -0.025794, -0.029609, -0.035473
#*# 	-0.009002, -0.006456, -0.004551, -0.000831, 0.002716, 0.006862, 0.009590, 0.009355, 0.008703, 0.013003, 0.013215, 0.010367, 0.007929, 0.005432, 0.001669, 0.003644, 0.002588, -0.001155, -0.006477, -0.013422, -0.021370, -0.025280, -0.026224, -0.031593, -0.038859
#*# 	-0.018282, -0.016787, -0.012890, -0.009804, -0.005881, -0.001873, 0.001911, 0.002342, 0.000908, 0.003890, 0.004602, 0.002632, 0.000000, -0.003857, -0.006880, -0.003813, -0.004392, -0.010145, -0.014314, -0.020534, -0.027019, -0.029940, -0.031705, -0.036384, -0.042243
#*# 	-0.022460, -0.021697, -0.019190, -0.015935, -0.013567, -0.011358, -0.007472, -0.006412, -0.008911, -0.004495, -0.002565, -0.003947, -0.008499, -0.012763, -0.016232, -0.014162, -0.013465, -0.019253, -0.024677, -0.031242, -0.037119, -0.039600, -0.039600, -0.044640, -0.051172
#*# 	-0.024308, -0.023463, -0.021260, -0.018632, -0.016580, -0.013824, -0.008666, -0.008237, -0.009184, -0.007345, -0.005488, -0.006551, -0.010666, -0.014262, -0.017131, -0.015549, -0.016297, -0.021842, -0.025849, -0.030722, -0.037508, -0.041148, -0.041753, -0.046671, -0.054909
#*# 	-0.016359, -0.016106, -0.013644, -0.010537, -0.008786, -0.005642, -0.000860, -0.002734, -0.003609, -0.002726, -0.001081, -0.001908, -0.002919, -0.006247, -0.007738, -0.004973, -0.005350, -0.009511, -0.014297, -0.019370, -0.026286, -0.031632, -0.033826, -0.037286, -0.045231
#*# 	0.005023, 0.005402, 0.008403, 0.009979, 0.010773, 0.012205, 0.015778, 0.015716, 0.014801, 0.016599, 0.017787, 0.016318, 0.013493, 0.010239, 0.009361, 0.009432, 0.009716, 0.006460, 0.001783, -0.002701, -0.009329, -0.014501, -0.016113, -0.018309, -0.024889
#*# 	0.021423, 0.023910, 0.026620, 0.029684, 0.029496, 0.029913, 0.032070, 0.030715, 0.030412, 0.032098, 0.034490, 0.033388, 0.031080, 0.027316, 0.024278, 0.023488, 0.022548, 0.018845, 0.016022, 0.012075, 0.005753, 0.002258, 0.000346, -0.003237, -0.008867
#*# 	0.030485, 0.033322, 0.034782, 0.037720, 0.039488, 0.037724, 0.036769, 0.037398, 0.035829, 0.037745, 0.040368, 0.038798, 0.039374, 0.035005, 0.031502, 0.029707, 0.028756, 0.027356, 0.025493, 0.022155, 0.016884, 0.011546, 0.010332, 0.007594, 0.000922
#*# 	0.040456, 0.041931, 0.044310, 0.047273, 0.046806, 0.046185, 0.046069, 0.046373, 0.046234, 0.048061, 0.050088, 0.049530, 0.047978, 0.044242, 0.041814, 0.040397, 0.039474, 0.037075, 0.034253, 0.030179, 0.025347, 0.019671, 0.018204, 0.016229, 0.012560
#*# 	0.057100, 0.056088, 0.060484, 0.060616, 0.059063, 0.059659, 0.060663, 0.058491, 0.058880, 0.062328, 0.066824, 0.066980, 0.062792, 0.058789, 0.057897, 0.058436, 0.057036, 0.054782, 0.051133, 0.045933, 0.039553, 0.034991, 0.035145, 0.035166, 0.032301
#*# 	0.073766, 0.074625, 0.074488, 0.074329, 0.073846, 0.073534, 0.073906, 0.073177, 0.073137, 0.075575, 0.078999, 0.079122, 0.075483, 0.072467, 0.070148, 0.070889, 0.071956, 0.071591, 0.067672, 0.063804, 0.059203, 0.056621, 0.057393, 0.057049, 0.053573
#*# 	0.090205, 0.089547, 0.087590, 0.087208, 0.088698, 0.088793, 0.087214, 0.085707, 0.088624, 0.091199, 0.094528, 0.095114, 0.092448, 0.088337, 0.088456, 0.090248, 0.090576, 0.088450, 0.086304, 0.084971, 0.082102, 0.079075, 0.079963, 0.078557, 0.073633
#*# 	0.098671, 0.098635, 0.100282, 0.100156, 0.101424, 0.104394, 0.104378, 0.104161, 0.104471, 0.107285, 0.111318, 0.113985, 0.111167, 0.107029, 0.108403, 0.110131, 0.110144, 0.110010, 0.107611, 0.106486, 0.103750, 0.099704, 0.098972, 0.097125, 0.092042
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 0.0
#*# max_x = 200.0
#*# min_y = 25.0
#*# max_y = 255.0
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 63.2
#*# shaper_type_y = mzv
#*# shaper_freq_y = 41.8
