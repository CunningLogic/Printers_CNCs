# This file contains common pin mappings for the BigTreeTech Octopus V1.
# To use this config, the firmware should be compiled for the STM32F446 with a "32KiB bootloader"
# Enable "extra low-level configuration options" and select the "12MHz crystal" as clock reference

# after running "make", copy the generated "klipper/out/klipper.bin" file to a
# file named "firmware.bin" on an SD card and then restart the OctoPus with that SD card.

# See docs/Config_Reference.md for a description of parameters.

## Voron Design VORON2 250/300/350mm BigTreeTech OctoPus V1 TMC2209 UART config

## *** THINGS TO CHANGE/CHECK: ***
## MCU paths                            [mcu] section
## Thermistor types                     [extruder] and [heater_bed] sections - See https://www.klipper3d.org/Config_Reference.html#common-thermistors for common thermistor types
## Z Endstop Switch location            [safe_z_home] section
## Homing end position                  [gcode_macro G32] section
## Z Endstop Switch  offset for Z0      [stepper_z] section
## Probe points                         [quad_gantry_level] section
## Min & Max gantry corner postions     [quad_gantry_level] section
## PID tune                             [extruder] and [heater_bed] sections
## Probe pin                            [probe] section
## Fine tune E steps                    [extruder] section

[include mainsail.cfg]

[force_move]
enable_force_move: True

# Enable arcs support
[gcode_arcs]
resolution: 0.1

[virtual_sdcard]
path: ~/printer_data/gcodes

[display_status]

[pause_resume]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_10000F000D50315939343520-if00
restart_method: command

[mcu can0]
canbus_uuid: e8e65c910c08

#[mcu nhk]
#serial: /dev/serial/by-id/usb-Klipper_rp2040_3033393834091DAB-if00
#restart_method: command

[include macros/*.cfg]
[include configs/*.cfg]
[include KAMP/KAMP_Settings.cfg]

[printer]
kinematics: corexy
max_velocity: 500 # 300  
max_accel: 15000             #Max 4000
max_z_velocity: 15          #Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

[temperature_sensor chamber_temp]
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: PF5
min_temp: 0
max_temp: 100
gcode_id: chamber_th

[temperature_sensor Octopus]
sensor_type: temperature_mcu

[temperature_sensor ToolHead]
sensor_type: temperature_mcu
sensor_mcu: can0
min_temp: 10
max_temp: 110

[adxl345]
cs_pin: can0:PB12
spi_software_sclk_pin: can0:PB10
spi_software_mosi_pin: can0:PB11
spi_software_miso_pin: can0:PB2
axes_map: x,y,z

[resonance_tester]
accel_chip: adxl345
probe_points:
    100,150,20  # an example for a 300mm printer
#    150,150,20  # an example for a 300mm printer

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [beacon model default]
#*# model_coef = 1.5574998988927542,
#*# 	  1.8781594346094326,
#*# 	  0.7472436551162199,
#*# 	  0.32307560051136175,
#*# 	  0.24902843863990146,
#*# 	  0.31587866699638223,
#*# 	  -0.062188662394223715,
#*# 	  -0.277091054712858,
#*# 	  0.10882713713591295,
#*# 	  0.16229276200854498
#*# model_domain = 3.2310889988856786e-07,3.327065344551111e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 33.608750
#*# model_offset = 0.00000
#*#
#*# [heater_bed]
#*# pid_version = 1
#*# pid_target = 105.00
#*# pid_tolerance = 0.0200
#*# control = pid
#*# pid_kp = 46.915
#*# pid_ki = 1.661
#*# pid_kd = 331.337
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 14.662
#*# pid_ki = 0.671
#*# pid_kd = 80.094
#*# pid_version = 1
#*# pid_target = 260.00
#*# pid_tolerance = 0.0200
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.168513, 0.172578, 0.178299, 0.189673, 0.199776, 0.198460, 0.192792, 0.176225, 0.162214, 0.152945, 0.150596, 0.144742, 0.139031, 0.135484, 0.128251, 0.130759, 0.135265, 0.149794, 0.160920, 0.181659, 0.188242, 0.184326, 0.172069, 0.171551, 0.160463
#*# 	0.152826, 0.153797, 0.159412, 0.172133, 0.181615, 0.182936, 0.177616, 0.159409, 0.144538, 0.135822, 0.139695, 0.133389, 0.127677, 0.123049, 0.120636, 0.118384, 0.122636, 0.133008, 0.151337, 0.168866, 0.174288, 0.167433, 0.160196, 0.154244, 0.148894
#*# 	0.135331, 0.136891, 0.141666, 0.153888, 0.164869, 0.165982, 0.155548, 0.140962, 0.126903, 0.122207, 0.121761, 0.118253, 0.112209, 0.107470, 0.105445, 0.102760, 0.105471, 0.115969, 0.134325, 0.152613, 0.158645, 0.152752, 0.145381, 0.138311, 0.131014
#*# 	0.118765, 0.117931, 0.123360, 0.137553, 0.149738, 0.149433, 0.137486, 0.123652, 0.110478, 0.106495, 0.107290, 0.104550, 0.099405, 0.094040, 0.091908, 0.088844, 0.091436, 0.100946, 0.118508, 0.137302, 0.145027, 0.136597, 0.130655, 0.124413, 0.118986
#*# 	0.104890, 0.104582, 0.109650, 0.121684, 0.133227, 0.134583, 0.123903, 0.108332, 0.094844, 0.089811, 0.091013, 0.088568, 0.083008, 0.078056, 0.076857, 0.073421, 0.075742, 0.085145, 0.104632, 0.121357, 0.128678, 0.120101, 0.114961, 0.107427, 0.102367
#*# 	0.089905, 0.088575, 0.093853, 0.106901, 0.118132, 0.121978, 0.108396, 0.091381, 0.078860, 0.074235, 0.073766, 0.071527, 0.063774, 0.062171, 0.059908, 0.059054, 0.061306, 0.071182, 0.088028, 0.105957, 0.112673, 0.105374, 0.099732, 0.091740, 0.089539
#*# 	0.074119, 0.073799, 0.079588, 0.092179, 0.102961, 0.106260, 0.094927, 0.079413, 0.064808, 0.056789, 0.059233, 0.056551, 0.053920, 0.048041, 0.045965, 0.043086, 0.048121, 0.056025, 0.073678, 0.091308, 0.097425, 0.089862, 0.080271, 0.076177, 0.071496
#*# 	0.059927, 0.058250, 0.066764, 0.076718, 0.090660, 0.088529, 0.081522, 0.065254, 0.050562, 0.045611, 0.044486, 0.045513, 0.037242, 0.035921, 0.032728, 0.031502, 0.029581, 0.040895, 0.057267, 0.078220, 0.084227, 0.077388, 0.070700, 0.063446, 0.062252
#*# 	0.050870, 0.051141, 0.057930, 0.069230, 0.083374, 0.084595, 0.076031, 0.058234, 0.042445, 0.037883, 0.035396, 0.031906, 0.027333, 0.026061, 0.021825, 0.018257, 0.015382, 0.029790, 0.047476, 0.071100, 0.074885, 0.068430, 0.060943, 0.056513, 0.052936
#*# 	0.046727, 0.042231, 0.050199, 0.067043, 0.078446, 0.080788, 0.069668, 0.052436, 0.041580, 0.033139, 0.030620, 0.024166, 0.024508, 0.020724, 0.017210, 0.013006, 0.015574, 0.025822, 0.044064, 0.062041, 0.069060, 0.067045, 0.056492, 0.050901, 0.044289
#*# 	0.039950, 0.040488, 0.047050, 0.059385, 0.070382, 0.071535, 0.060412, 0.042507, 0.027539, 0.023822, 0.021287, 0.022225, 0.016328, 0.015764, 0.007300, 0.005060, 0.007487, 0.018532, 0.038248, 0.051651, 0.062607, 0.057497, 0.051967, 0.044404, 0.041589
#*# 	0.033122, 0.033544, 0.040316, 0.052675, 0.058325, 0.062705, 0.051203, 0.033401, 0.015104, 0.017159, 0.016650, 0.014124, 0.006929, 0.002556, 0.002274, -0.006155, -0.001171, 0.009284, 0.030527, 0.049202, 0.056148, 0.047485, 0.045063, 0.035603, 0.036944
#*# 	0.027040, 0.027077, 0.033772, 0.047320, 0.052032, 0.056147, 0.044409, 0.029164, 0.013208, 0.011616, 0.013106, 0.009863, 0.002203, -0.007420, -0.008456, -0.010793, -0.004604, 0.002759, 0.025947, 0.043571, 0.056720, 0.048085, 0.042005, 0.031640, 0.034416
#*# 	0.024802, 0.026242, 0.029252, 0.043669, 0.053825, 0.053519, 0.043584, 0.029218, 0.010301, 0.008544, 0.006355, 0.008135, 0.000000, -0.005702, -0.017404, -0.015494, -0.009309, 0.003064, 0.022852, 0.040859, 0.054045, 0.047482, 0.042852, 0.040199, 0.036112
#*# 	0.025958, 0.022519, 0.031258, 0.046034, 0.055957, 0.055556, 0.044721, 0.022008, 0.009349, 0.008744, 0.011069, 0.003618, -0.000245, -0.008438, -0.012315, -0.019983, -0.013242, -0.000169, 0.021825, 0.039718, 0.042271, 0.046321, 0.042897, 0.040625, 0.035952
#*# 	0.025769, 0.025161, 0.031761, 0.044709, 0.060139, 0.054692, 0.043561, 0.018485, 0.007555, 0.007421, 0.008632, 0.004251, -0.003711, -0.005343, -0.018865, -0.022363, -0.020356, -0.003238, 0.018538, 0.036569, 0.042711, 0.045852, 0.042227, 0.044618, 0.037036
#*# 	0.025436, 0.025916, 0.032289, 0.046211, 0.059773, 0.052710, 0.043684, 0.023512, 0.010015, 0.004539, 0.006101, 0.002298, -0.005044, -0.011755, -0.023274, -0.022677, -0.016376, 0.000791, 0.016482, 0.035980, 0.045867, 0.049583, 0.041196, 0.046410, 0.037742
#*# 	0.031259, 0.030605, 0.036225, 0.050757, 0.061688, 0.060778, 0.051249, 0.026915, 0.010483, 0.006322, 0.011393, 0.002787, -0.002992, -0.014615, -0.017305, -0.020697, -0.014507, -0.002428, 0.016001, 0.038174, 0.047812, 0.046073, 0.038046, 0.043545, 0.040668
#*# 	0.044282, 0.043955, 0.049046, 0.060945, 0.072222, 0.069682, 0.055709, 0.037598, 0.018059, 0.017441, 0.016629, 0.013369, 0.004843, -0.003130, -0.009569, -0.010493, -0.009016, 0.002876, 0.022005, 0.041753, 0.053532, 0.046901, 0.049401, 0.049589, 0.051501
#*# 	0.056336, 0.053154, 0.059757, 0.076118, 0.084218, 0.081016, 0.062728, 0.046838, 0.031882, 0.027157, 0.026754, 0.021666, 0.020295, 0.007859, 0.002299, -0.002292, 0.006211, 0.014093, 0.034861, 0.053568, 0.066421, 0.064159, 0.061148, 0.062664, 0.059931
#*# 	0.069113, 0.067111, 0.068984, 0.084896, 0.094905, 0.093802, 0.077361, 0.057084, 0.042234, 0.040215, 0.036904, 0.032673, 0.026519, 0.018527, 0.011753, 0.004033, 0.012303, 0.025594, 0.051453, 0.069189, 0.079527, 0.076592, 0.077282, 0.075235, 0.073902
#*# 	0.083415, 0.077800, 0.080854, 0.094198, 0.103999, 0.103643, 0.086356, 0.064122, 0.051028, 0.050318, 0.046187, 0.040959, 0.030192, 0.027348, 0.020068, 0.017278, 0.022165, 0.037770, 0.060388, 0.082559, 0.091848, 0.090694, 0.090188, 0.088211, 0.088726
#*# 	0.089612, 0.089474, 0.093345, 0.107340, 0.116519, 0.111470, 0.098034, 0.075887, 0.061380, 0.057147, 0.057004, 0.050703, 0.044099, 0.035541, 0.028775, 0.025139, 0.033603, 0.046762, 0.068865, 0.093590, 0.104137, 0.102325, 0.098204, 0.100561, 0.100032
#*# 	0.112156, 0.107773, 0.110593, 0.122477, 0.132170, 0.124913, 0.112428, 0.091097, 0.076844, 0.073267, 0.071248, 0.067399, 0.058685, 0.049872, 0.042739, 0.041451, 0.045163, 0.060752, 0.083513, 0.107037, 0.117763, 0.116645, 0.115600, 0.114677, 0.113761
#*# 	0.128460, 0.125500, 0.127049, 0.137931, 0.148094, 0.142918, 0.127840, 0.108456, 0.094808, 0.091078, 0.088210, 0.082751, 0.076152, 0.068265, 0.060702, 0.057762, 0.062052, 0.077430, 0.099252, 0.122243, 0.133972, 0.132694, 0.131365, 0.131610, 0.130168
#*# x_count = 25
#*# y_count = 25
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.1
#*# min_x = 0.0
#*# max_x = 200.0
#*# min_y = 25.0
#*# max_y = 255.0
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 64.4
#*# shaper_type_y = 3hump_ei
#*# shaper_freq_y = 74.6
